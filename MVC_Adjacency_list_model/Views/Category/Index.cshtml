@model List<MVC_Adjacency_list_model.ViewModels.CategoryCarrierViewModel>
@{
    ViewBag.Title = "Tree";
}

@helper TreeView(List<MVC_Adjacency_list_model.ViewModels.CategoryCarrierViewModel> categoryTree, int counter)
{
    string typeClass = null;
    if (categoryTree.Count() > 0)
    {
        counter++;
        @:<ul>
            foreach (var item in categoryTree)
            {
                //jeśli jest liściem
                if (item.deeperList.Count == 0)
                {
                    typeClass = "leaf";
                }
                else
                {
                    typeClass = "node";
                }
                <li class="@typeClass" data-my-content="@item.Name" data-my-level="@counter">@item.Name@DisplayMenu(item)@*sprawdza dalej*@@TreeView(item.deeperList, counter)</li>
            }
        @:</ul>
    }

}



@helper DisplayMenu(MVC_Adjacency_list_model.ViewModels.CategoryCarrierViewModel item)
{<div style="display: inline-block;" class="display-menu">
        @*RENAME BUTTON*@
        @Html.ActionLink("✏️  ", "RenameNode", "Category", new { id = item.ID }, new { @class = "small-font", title = "Rename" })

        @*DELETE BUTTON*@
        <a class="small-font" title="Delete" href="javascript:deleteCategory(@item.ID);">🗑️</a>

        @*//NEW_NODE BUTTON*@
        @Html.ActionLink("➕  ", "NewNode", "Category", new { id = item.ID }, new { @class = "small-font", title = "Add new" })

        @*//SORT BUTTON*@
        @if (item.deeperList.Count > 1)
        {
            <a class="small-font" id="newClick">sort</a>
        }
    </div>
}



<h2>Here is your structure as a tree!</h2>
<hr />
<a href="/Category/MoveNode" class="btn btn-primary" style="padding: 5px 5px; font-size:x-small">Move node</a>






@Html.ActionLink("➕  ", "NewNode", "Category", new { id = 1 }, new { title = "New Root Node" })
<a title="Toggle" id="toggleButton">[Toggle all]</a>
@*USE HELPER TO DISPLAY LIST*@
<div id="listDiv">
    @TreeView(Model, 0)
</div>


@Scripts.Render(
  "~/bundles/TreeScripts")

@section scripts
{
    <script>
        $(document).ready(function () {
            AddListClasses();
        });

        $("#toggleButton").click(function () {
            toggleAllCategories();
        });

        $('ul li').click(function (e) {
            e.stopPropagation();
            $(this).children('.subLink').toggle('slow');
        });

        $("#listDiv a").click(function (e) {
            e.stopPropagation();
        });
    </script>
}
