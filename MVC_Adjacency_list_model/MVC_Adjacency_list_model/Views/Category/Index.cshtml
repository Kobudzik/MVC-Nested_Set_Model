@model List<MVC_Adjacency_list_model.ViewModels.CategoryCarrierViewModel>


@helper TreeView(List<MVC_Adjacency_list_model.ViewModels.CategoryCarrierViewModel> categoryTree)
{

    string leaf = null;
    string leafSymbol = null;
    if (categoryTree.Count() > 0)
    {
        @:<ul>
            foreach (var item in categoryTree)
            {
                if (item.deeperList.Count == 0)
                {
                    leaf = "leaf";
                    leafSymbol = "🍀";
                }
                else
                {
                    leaf = null;
                    leafSymbol = null;
                }
                <li class="@leaf" title="@leaf"> @leafSymbol @item.Name@DisplayMenu(item)@*sprawdza dalej*@@TreeView(item.deeperList)</li>
            }
        @:</ul>
    }

}



@helper DisplayMenu(MVC_Adjacency_list_model.ViewModels.CategoryCarrierViewModel item)
{<div style="display: inline-block;" class="display-menu">
        @Html.ActionLink("✏️  ", "Rename", "Category", new { id = item.ID }, new { @class = "small-font", title = "Rename" })
        <a class="small-font" title="Delete" href="javascript:deleteScript(@item.ID);">🗑️</a>
        @Html.ActionLink("➕  ", "NewNode", "Category", new { id = item.ID }, new { @class = "small-font", title = "Add new" })
        <a class="small-font" id="newClick">sortNew</a>
    </div>
}



<h2>Here is your structure as tree!</h2>
<button class="btn navbar-btn">@Html.ActionLink("️Move node", "DeleteById", "Category", null)</button>
<hr />


@Html.ActionLink("➕  ", "NewNode", "Category", new { id = 1 }, new { @class = "small-font" })
<a class="small-font" title="Toggle" id="toggleButton">[Toggle all]</a>
@*USE HELPER TO DISPLAY LIST*@
<div id="listDiv">
    @TreeView(Model)
</div>


@section scripts
{
    <script>
        //***********DELETING************\\
        function deleteScript(ID) {
            bootbox.confirm("Are you sure you want to delete this node?", function (bootboxResult) {
                if (bootboxResult) {
                    $.ajax({
                        url: "/api/category/" + ID,
                        method: "DELETE",
                        success: function (bootboxSucces) {
                            location.reload();
                        }
                    });
                }
            });
        }
        //***********DELETING************\\
        $("#toggleButton").click(function () {
            if ($('.subLink:visible').length)
                $('.subLink').hide("fast");
            else
                $('.subLink').show("fast");
        });



        $(document).ready(function () {
            //***********TOGGLING************\\

            $('li:has(ul)').addClass('link');
            $('ul ul').addClass('subLink');

            $('ul li').click(function (toggle) {  // inserted callback param EVENT
                toggle.stopPropagation(); // stop click from bubbling up
                $(this).children('.subLink').toggle('slow');
            });


            //<a> (display menu) toggling fix
            $("#listDiv a").click(function (e) {
                e.stopPropagation();
            });
            //***********TOGGLING************\\





        });

        $('#newClick').click(function (toggle) {  // inserted callback param EVENT
            toggle.stopPropagation();
            $("li:first-child").addClass("red");
            alert($("li:first-child").text());

        });





    </script>
}